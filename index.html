<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Estudio de Fórceps</title>

<style>

body {
    font-family: Arial;
    background: #121212;
    color: white;
    text-align: center;
    padding: 20px;
}

h1 {
    margin-bottom: 5px;
}

#imageContainer {
    margin: 20px;
}

img {
    max-width: 500px;
    max-height: 400px;
    border-radius: 10px;
    border: 3px solid white;
}

select {
    padding: 12px;
    font-size: 18px;
    width: 400px;
    margin-top: 15px;
    border-radius: 5px;
}

button {
    padding: 10px 20px;
    font-size: 18px;
    margin: 10px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
}

button:hover {
    background: #444;
    color: white;
}

#result {
    font-size: 22px;
    margin-top: 15px;
    height: 30px;
}

#score {
    margin-top: 10px;
    font-size: 18px;
}

#progress {
    margin-top: 5px;
    color: #aaa;
}

.correct {
    color: lightgreen;
}

.incorrect {
    color: red;
}

</style>

</head>
<body>

<h1>Estudio de Fórceps</h1>

<div id="progress"></div>

<div id="imageContainer">
    <img id="forcepsImage">
</div>

<div>
    <select id="answerSelect">
        <option value="">-- Selecciona una opción --</option>
    </select>
</div>

<div>
    <button onclick="checkAnswer()">Comprobar</button>
    <button onclick="nextForceps()">Siguiente</button>
</div>

<div id="result"></div>
<div id="score"></div>

<script>

let forcepsList = [];
let currentIndex = 0;
let correct = 0;
let total = 0;


// CARGAR JSON

fetch("forceps.json")
.then(response => response.json())
.then(data => {

    forcepsList = data;

    shuffle(forcepsList);

    populateDropdown();

    loadForceps();

});


// MEZCLAR ARRAY

function shuffle(array) {

    for (let i = array.length - 1; i > 0; i--) {

        const j = Math.floor(Math.random() * (i + 1));

        [array[i], array[j]] = [array[j], array[i]];

    }

}


// LLENAR DROPDOWN

function populateDropdown() {

    const select = document.getElementById("answerSelect");

    select.innerHTML =
        '<option value="">-- Selecciona una opción --</option>';

    forcepsList.forEach(item => {

        const option = document.createElement("option");

        option.value = item.name;

        option.textContent = item.name;

        select.appendChild(option);

    });

}


// CARGAR IMAGE ACTUAL

function loadForceps() {

    const item = forcepsList[currentIndex];

    document.getElementById("forcepsImage").src =
        "images/" + item.image;

    document.getElementById("answerSelect").value = "";

    document.getElementById("result").textContent = "";

    document.getElementById("progress").textContent =
        "Imagen " + (currentIndex + 1) +
        " de " + forcepsList.length;

}


// COMPROBAR RESPUESTA

function checkAnswer() {

    const selected =
        document.getElementById("answerSelect").value;

    if(selected === "") return;

    const correctName =
        forcepsList[currentIndex].name;

    total++;

    if(selected === correctName) {

        correct++;

        showResult(true, correctName);

    } else {

        showResult(false, correctName);

    }

    updateScore();

}


// MOSTRAR RESULTADO

function showResult(isCorrect, correctName) {

    const result = document.getElementById("result");

    if(isCorrect) {

        result.textContent = "✅ Correcto";

        result.className = "correct";

    } else {

        result.textContent =
            "❌ Incorrecto — Era: " + correctName;

        result.className = "incorrect";

    }

}


// SIGUIENTE

function nextForceps() {

    currentIndex++;

    if(currentIndex >= forcepsList.length) {

        shuffle(forcepsList);

        currentIndex = 0;

    }

    loadForceps();

}


// ACTUALIZAR SCORE

function updateScore() {

    const percent =
        total > 0 ?
        Math.round(correct/total*100) : 0;

    document.getElementById("score").textContent =
        "Aciertos: " + correct +
        " / " + total +
        " (" + percent + "%)";

}

</script>

</body>
</html>